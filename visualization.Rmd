---
title: "Visualization"
output: html_document
#  html_notebook:
#    css: duke.css
---

When in the data exploratory phase, you can quickly generate very basic visualizations with minimal effort.  Your visualizations then appear in the Viewer Pane.  

For this introductory section on visualization we use the `ggvis` package because it works seemlessly with pipes (i.e. `%>%`).  You can do a lot of [ggvis](http://ggvis.rstudio.com/).  You can do even more with [ggplot2](http://ggplot2.tidyverse.org/).  We offer a separate workshop on ggplot2.

```{r, echo=TRUE, message=FALSE, warning=FALSE}
library(tidyverse)
library(ggvis)
```


```{r transform-cars, message=FALSE, warning=FALSE, include=FALSE}
# There is some crazy data conversion problem with the cars dataFrame.  But since I only did that to show people how to load data  (see data_management.Rmd,)  I'm transforming 'cars' in a more robust fashion with `rownames_to_column`
cars <- rownames_to_column(mtcars, "makeModel")

makeModel_temp <- cars$makeModel

cars$makeModel <- NULL

cars$makeModel <- makeModel_temp
  
```


## Scatter Plot
Linear model and 95% confidence interval
```{r ggvis-scatter}
cars %>% 
  ggvis(~wt, ~mpg) %>% 
  layer_points() %>% 
  layer_model_predictions(model = "lm", se=TRUE)
```
[More information on ggvis scatterplots](http://ggvis.rstudio.com/cookbook.html#scatterplots)

## Bar Graph
```{r ggvis-bargraph}
cars %>% 
  mutate(cyl = factor(cyl, labels = c("four","six","eight"))) %>% 
  ggvis(~cyl) %>% 
  layer_bars()
```
[More information on ggvis bar graphs](http://ggvis.rstudio.com/cookbook.html#bar-graphs)

## Histogram
```{r ggvis-hist, message=FALSE}
cars %>% 
  ggvis(~mpg) %>% 
  layer_histograms()
```
[More information on ggvis histograms](http://ggvis.rstudio.com/cookbook.html#histograms)

## Line graph
```{r ggvis-line, warning=FALSE}
cars %>% 
  ggvis(~wt, ~mpg) %>% 
  group_by(cyl) %>% 
  layer_lines(stroke = ~factor(cyl)) %>% 
  layer_points(~wt, ~mpg, stroke := "black", fill = ~factor(cyl))
```
[More information on line graphs](http://ggvis.rstudio.com/cookbook.html#line-graphs)

```{r ggvis-linesmooth, warning=FALSE, message=FALSE}
cars %>% 
  ggvis(~wt, ~mpg) %>% 
  group_by(cyl) %>% 
  layer_model_predictions(model="lm", se = TRUE) %>% 
  layer_points(~wt, ~mpg, stroke := "black", fill = ~factor(cyl), size := ~hp, opacity := 0.7) 
```
